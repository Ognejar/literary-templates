# Карточка функционала: Новое_государство.md

## Общая информация
- **Файл**: `templates/Новое_государство.md`
- **Назначение**: Шаблон для создания государств в литературных проектах
- **Тип**: Политический шаблон локации
- **Зависимости**: `createState.js`, `StateWizardModal.js`

## Структура шаблона

### Frontmatter
| Параметр | Тип | Описание | Пример |
|----------|-----|----------|--------|
| `created` | string | Дата создания | "2025-08-11" |
| `name` | string | Название государства | "Королевство_1" |
| `aliases` | array | Альтернативные названия | ["Королевство_1"] |
| `type` | string | Тип локации | "Государство" |
| `tags` | array | Теги для классификации | [place, государство] |
| `capital` | string | Столица государства | "Хаген" |
| `governmentType` | string | Тип правительства | "Монархия" |
| `leader` | string | Лидер государства | "Король Альберт" |
| `population` | string | Численность населения | "500,000" |
| `languages` | array | Официальные языки | ["Общий", "Эльфийский"] |
| `climate` | string | Климатическая зона | "Умеренный" |
| `currency` | string | Национальная валюта | "Золотая монета" |

### Основной контент

#### Изображение
- **Параметр**: `{{imageBlock}}`
- **Описание**: Автоматически найденное изображение государства
- **Формат**: `![[путь_к_картинке]]`
- **Поиск**: В папке `Теговые_картинки` по типу "Государство"

#### Заголовок и основная информация
- **Заголовок**: `{{stateName}}` - название государства
- **Столица**: `{{capital}}` - столичный город
- **Тип правительства**: `{{governmentType}}` - форма правления
- **Лидер**: `{{leader}}` - глава государства
- **Численность населения**: `{{population}}` - демографические данные
- **Официальные языки**: `{{language1}}`, `{{language2}}` - языки (с условным отображением)
- **Валюта**: `{{currency}}` - национальная валюта
- **Климат**: `{{climate}}` - климатическая зона

#### Основные разделы
| Раздел | Параметр | Описание |
|--------|----------|----------|
| География | `{{location}}` | Географическое положение |
| Ресурсы | `{{resources}}` | Природные ресурсы |
| История | `{{history}}` | Историческое развитие |

#### Культурные разделы
| Раздел | Параметр | Описание |
|--------|----------|----------|
| Традиции | `{{traditions}}` | Культурные традиции |
| Религия | `{{religion}}` | Религиозные верования |
| Праздники | `{{festivals}}` | Национальные праздники |

#### Экономические разделы
| Раздел | Параметр | Описание |
|--------|----------|----------|
| Основные отрасли | `{{mainIndustries}}` | Экономические отрасли |
| Торговые партнеры | `{{tradePartners}}` | Внешнеторговые связи |
| Экономические вызовы | `{{economicChallenges}}` | Экономические проблемы |

#### Политические разделы
| Раздел | Параметр | Описание |
|--------|----------|----------|
| Внутренняя политика | `{{domesticPolicy}}` | Внутриполитические аспекты |
| Внешняя политика | `{{foreignPolicy}}` | Международные отношения |
| Военные силы | `{{military}}` | Вооруженные силы |

#### Социальные разделы
| Раздел | Параметр | Описание |
|--------|----------|----------|
| Образование | `{{education}}` | Система образования |
| Здравоохранение | `{{healthcare}}` | Медицинская система |
| Социальные проблемы | `{{socialIssues}}` | Социальные вызовы |
| Заметки для развития | `{{developmentNotes}}` | Планы развития |

#### Автоматические связи
- **Задачи государства**: `TASK FROM "" WHERE !completed AND (startswith(file.folder, this.file.folder) OR contains(file.outlinks, this.file.link))`
- **Провинции государства**: `LIST FROM "" WHERE type = "Провинция" AND state = this.name`
- **Города государства**: `LIST FROM "" WHERE type = "Город" AND (country = this.name OR state = this.name)`
- **Фортификации государства**: `LIST FROM "" WHERE tags AND contains(tags, "фортификация") AND (country = this.name OR state = this.name)`

## Параметры из createState.js

### Обязательные параметры
- `stateName` - название государства
- `capital` - столица
- `governmentType` - тип правительства
- `leader` - лидер
- `population` - численность населения
- `language1` - основной язык
- `climate` - климат
- `currency` - валюта

### Опциональные параметры
- `language2` - второй язык
- `location` - географическое положение
- `resources` - природные ресурсы
- `history` - историческое развитие
- `traditions` - культурные традиции
- `religion` - религиозные верования
- `festivals` - национальные праздники
- `mainIndustries` - основные отрасли
- `tradePartners` - торговые партнеры
- `economicChallenges` - экономические вызовы
- `domesticPolicy` - внутренняя политика
- `foreignPolicy` - внешняя политика
- `military` - военные силы
- `education` - система образования
- `healthcare` - медицинская система
- `socialIssues` - социальные проблемы
- `developmentNotes` - заметки для развития

### Автоматически генерируемые
- `date` - дата создания
- `projectName` - название проекта
- `imageBlock` - блок с изображением

## Интеграция с системой

### Связи с другими сущностями
- **Провинции**: Государство является родительским элементом для провинций через поле `state`
- **Города**: Связь через поля `country` или `state` в записях городов
- **Фортификации**: Связь через поля `country` или `state` в записях фортификаций
- **Климаты**: Указан климат региона
- **Задачи**: Автоматическое отображение связанных задач

### Dataview интеграция
- Автоматическое отображение всех связанных административных единиц
- Фильтрация по типу и государству
- Исключение текущего файла из списков
- Поддержка тегов для фортификаций
- Отображение задач с приоритизацией по дате изменения

## Пример использования

```javascript
// В createState.js
const data = {
    stateName: "Королевство_1",
    capital: "Хаген",
    governmentType: "Монархия",
    leader: "Король Альберт",
    population: "500,000",
    language1: "Общий",
    language2: "Эльфийский",
    climate: "Умеренный",
    currency: "Золотая монета",
    location: "Центральная часть континента...",
    resources: "Железная руда, древесина, плодородные земли",
    history: "Основано в 1200 году...",
    traditions: "Рыцарские турниры, праздник урожая",
    religion: "Поклонение древним богам",
    festivals: "День коронации, праздник весны",
    mainIndustries: "Сельское хозяйство, ремёсла, торговля",
    tradePartners: "Соседние королевства, торговые города",
    economicChallenges: "Нестабильность цен на зерно",
    domesticPolicy: "Поддержка местных ремесленников",
    foreignPolicy: "Нейтралитет в международных конфликтах",
    military: "Королевская гвардия, ополчение",
    education: "Церковные школы, частные учителя",
    healthcare: "Травники, алхимики",
    socialIssues: "Неравенство между сословиями",
    developmentNotes: "Планируется строительство новых дорог",
    date: "2025-08-11",
    projectName: "заявсь",
    imageBlock: "![[Теговые_картинки/Государство.jpg]]"
};
```

## Особенности шаблона

### Политическая структура
- Шаблон отражает полную политическую структуру государства
- Включает все аспекты управления: политику, экономику, культуру, общество
- Поддерживает сложные связи между административными единицами

### Условное отображение
- Второй язык отображается только если указан: `{{#if language2}}, {{language2}}{{/if}}`
- Это позволяет создавать как моноязычные, так и многоязычные государства

### Автоматические связи
- Государство является вершиной административной иерархии
- Все Dataview запросы автоматически обновляются при создании новых локаций
- Поддержка исключения текущего файла из списков
- Отображение задач с приоритизацией

### Комплексность
- Шаблон охватывает все аспекты государственного устройства
- Подходит для создания как простых, так и сложных государств
- Опциональные разделы позволяют адаптировать под конкретные нужды

## История изменений
- **2025-01-09**: Интеграция с StateWizardModal
- **2024-12-19**: Добавлена поддержка изображений через imageBlock
- **2024-12-19**: Добавлен блок задач государства
- **2024-12-19**: Создана первая версия шаблона

## Зависимости
- `createState.js` - логика создания
- `StateWizardModal.js` - мастер ввода данных
- `settingsService.js` - получение настроек мира
- `Теговые_картинки/Государство.jpg` - изображение государства
