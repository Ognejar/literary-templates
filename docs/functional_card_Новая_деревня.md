# Карточка функционала: Новая_деревня.md

## Общая информация
- **Файл**: `templates/Новая_деревня.md`
- **Назначение**: Шаблон для создания деревень в литературных проектах
- **Тип**: Основной шаблон локации
- **Зависимости**: `createVillage.js`, `VillageWizardModal.js`

## Структура шаблона

### Frontmatter
| Параметр | Тип | Описание | Пример |
|----------|-----|----------|--------|
| `created` | string | Дата создания | "2025-08-11" |
| `name` | string | Название деревни | "Хряковка" |
| `aliases` | array | Альтернативные названия | ["Хряковка"] |
| `type` | string | Тип локации | "Деревня" |
| `tags` | array | Теги для классификации | [place, деревня] |
| `project` | string | Название проекта | "заявсь" |
| `climate` | string | Климатическая зона | "Умеренный" |
| `faction` | string | Доминирующая фракция | "Гильдии" |
| `province` | string | Ссылка на провинцию | "Торвальд" |

### Основной контент

#### Изображение
- **Параметр**: `{{imageBlock}}`
- **Описание**: Автоматически найденное изображение деревни
- **Формат**: `![[путь_к_картинке]]`
- **Поиск**: В папке `Теговые_картинки` по типу "Деревня"

#### Заголовок и основная информация
- **Заголовок**: `{{villageName}}` - название деревни
- **Тип**: Деревня (фиксированное значение)
- **Климат**: `{{climate}}` - климатическая зона
- **Фракция**: `{{faction}}` - основная фракция
- **Провинция**: `[[{{province}}]]` - ссылка на провинцию

#### Основные разделы
| Раздел | Параметр | Описание |
|--------|----------|----------|
| Описание | `{{description}}` | Подробное описание деревни |
| Население | `{{population}}` | Численность населения |
| Основные культуры | `{{mainCropsSection}}` | Сельскохозяйственные культуры |
| Ремёсла | `{{craftsSection}}` | Ремесленные занятия |
| Особенности | `{{featuresSection}}` | Уникальные особенности |

#### Статические разделы
- **Экономика**: Описание экономической структуры деревни
- **Культура**: Религия, обычаи, праздники
- **Современные проблемы**: Затопление, миграция, экономические трудности

#### Автоматические связи
- **Жители деревни**: `list from #people OR #character where village = this.name`
- **Деревни провинции**: `list from "" where type = "Деревня" and province = this.province`

## Параметры из createVillage.js

### Обязательные параметры
- `villageName` - название деревни
- `climate` - климат
- `faction` - доминирующая фракция
- `province` - провинция
- `description` - описание

### Опциональные параметры
- `population` - численность населения
- `mainCropsSection` - основные сельскохозяйственные культуры
- `craftsSection` - ремесленные занятия
- `featuresSection` - особенности деревни

### Автоматически генерируемые
- `date` - дата создания
- `projectName` - название проекта
- `imageBlock` - блок с изображением

## Интеграция с системой

### Связи с другими сущностями
- **Провинции**: Деревня привязана к провинции через поле `province`
- **Государства**: Связь через провинцию
- **Фракции**: Указана доминирующая фракция
- **Климаты**: Указан климат региона
- **Персонажи**: Связь через поле `village` в записях персонажей

### Dataview интеграция
- Автоматическое отображение жителей деревни
- Автоматическое отображение других деревень в провинции
- Фильтрация по типу и провинции

## Пример использования

```javascript
// В createVillage.js
const data = {
    villageName: "Хряковка",
    climate: "Умеренный",
    faction: "Гильдии",
    province: "Торвальд",
    description: "Небольшая деревня на берегу реки...",
    population: "150 человек",
    mainCropsSection: "- Пшеница\n- Картофель\n- Овощи",
    craftsSection: "- Гончарное дело\n- Плетение корзин",
    featuresSection: "- Старая мельница\n- Рыбацкая пристань",
    date: "2025-08-11",
    projectName: "заявсь",
    imageBlock: "![[Теговые_картинки/Деревня.jpg]]"
};
```

## Особенности шаблона

### Статический контент
- Шаблон содержит предустановленные разделы для экономики, культуры и проблем
- Это отражает типичную структуру сельского поселения
- Пользователь может дополнить или изменить эти разделы

### Связи с персонажами
- Уникальная особенность: деревня может быть связана с персонажами через поле `village`
- Это позволяет отслеживать жителей конкретной деревни

### Сельскохозяйственная направленность
- Шаблон специально адаптирован для сельских поселений
- Включает разделы для культур, ремёсел и сельского хозяйства

## История изменений
- **2025-01-09**: Интеграция с VillageWizardModal
- **2024-12-19**: Добавлена поддержка изображений через imageBlock
- **2024-12-19**: Создана первая версия шаблона

## Зависимости
- `createVillage.js` - логика создания
- `VillageWizardModal.js` - мастер ввода данных
- `settingsService.js` - получение настроек мира
- `Теговые_картинки/Деревня.jpg` - изображение деревни
