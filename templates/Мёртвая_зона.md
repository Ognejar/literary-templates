<%*
const projectRootPath = tp.file.find_tfile('Настройки_мира.md')?.parent?.path || '';
const deadZonesFolder = `${projectRootPath}/Локации/Мёртвые_зоны`;
const zoneName = await tp.system.prompt('Название мёртвой зоны/заброшенного промысла?');
const type = await tp.system.suggester(['Затопленная деревня','Заброшенная шахта','Мёртвый лес','Руины','Другое'],['Затопленная деревня','Заброшенная шахта','Мёртвый лес','Руины','Другое']);
const era = await tp.system.prompt('Период/эпоха (по желанию)?');
const description = await tp.system.prompt('Краткое описание зоны?');
const oldEconomy = await tp.system.prompt('Чем здесь занимались до катастрофы?');
const currentState = await tp.system.prompt('Что осталось, какие опасности, кто бывает сейчас?');
const findings = await tp.system.prompt('Что можно найти (артефакты, ресурсы, монстры)?');
const cleanName = zoneName.replace(/[/\\?%*:|"<>]/g, '').replace(/\s+/g, '_');
const newFullFileName = `${deadZonesFolder}/${cleanName}.md`;
if (await app.vault.adapter.exists(newFullFileName)) {
  new Notice('Файл зоны уже существует!');
  throw 'Файл зоны уже существует!';
}
await tp.file.create_new('', newFullFileName);
tR += `---\ncreated: ${tp.date.now('YYYY-MM-DD')}\nname: ${zoneName}\ntype: ${type}\nera: ${era}\ntags: [deadzone, abandoned, location]\n---\n\n# ${zoneName}\n\n**Тип:** ${type}\n**Период:** ${era}\n\n## Описание\n${description}\n\n## Прошлая экономика\n${oldEconomy}\n\n## Современное состояние\n${currentState}\n\n## Находки и опасности\n${findings}\n\n## Магия и техномагия
- Есть ли следы магии, артефакты, опасные зоны?
- Как магия повлияла на судьбу этого места?
\n\n## Автоматические связи\n### События зоны\n\`\`\`dataview\nLIST FROM #event\nWHERE (contains(file.outlinks, [[${zoneName}]] ) OR contains(file.tags, "${zoneName}") OR regexmatch(file.text, "#${zoneName}") OR regexmatch(file.text, "\\[\\[${zoneName}(\\||\\]\\])"))\n\`\`\`\n\n### Персонажи зоны\n\`\`\`dataview\nLIST FROM #character\nWHERE (contains(file.outlinks, [[${zoneName}]] ) OR contains(file.tags, "${zoneName}") OR regexmatch(file.text, "#${zoneName}") OR regexmatch(file.text, "\\[\\[${zoneName}(\\||\\]\\])"))\n\`\`\`\n`;
%>